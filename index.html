  <!DOCTYPE html>
<html lang="zh-CN">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>计量器具管理系统</title>
  <style>
    /* 原有样式保持不变 */
    .navbar {
      background-color: #333;
      padding: 15px 0;
      position: sticky;
      top: 0;
      z-index: 100;
    }
    .nav-container {
      max-width: 1000px;
      margin: 0 auto;
      padding: 0 20px;
    }
    .nav-links {
      display: flex;
      list-style: none;
      gap: 25px;
    }
    .nav-links a {
      color: white;
      text-decoration: none;
      font-weight: 500;
      transition: color 0.3s;
    }
    .nav-links a:hover {
      color: #4a90e2;
    }
    .nav-links a.active {
      color: #4a90e2;
      border-bottom: 2px solid #4a90e2;
    }

    .container { max-width: 1000px; margin: 0 auto; padding: 20px; }
    .section { 
      margin-bottom: 50px; 
      padding: 20px; 
      border: 1px solid #eee; 
      border-radius: 6px;
      scroll-margin-top: 80px; /* 适配导航栏高度 */
    }
    .load-area { display: flex; flex-wrap: wrap; gap: 20px; }
    .load-card { 
      flex: 1 1 300px; 
      padding: 20px; 
      border: 1px dashed #ddd; 
      border-radius: 6px; 
      text-align: center; 
    }
    .load-btn { 
      padding: 10px 20px; 
      background-color: #4a90e2; 
      color: white; 
      border: none; 
      border-radius: 4px; 
      cursor: pointer; 
      margin-top: 10px;
      transition: background-color 0.3s;
    }
    .load-btn:hover { background-color: #357abd; }
    .load-btn:disabled { background-color: #999; cursor: not-allowed; }
    .content-loading { 
      color: #999; 
      font-size: 14px; 
      margin-top: 10px; 
    }
    .dynamic-content { 
      margin-top: 20px; 
      padding: 15px; 
      background-color: #f9f9f9; 
      border-radius: 4px; 
      display: none; 
      text-align: left;
    }
    .tab-buttons { 
      display: flex; 
      gap: 10px; 
      margin-bottom: 15px; 
      border-bottom: 1px solid #eee; 
      padding-bottom: 10px;
    }
    .tab-btn { 
      padding: 8px 15px; 
      background-color: #f5f5f5; 
      border: 1px solid #ddd; 
      border-radius: 4px; 
      cursor: pointer;
    }
    .tab-btn.active { 
      background-color: #4a90e2; 
      color: white; 
      border-color: #4a90e2;
    }
    .tab-content { margin-top: 10px; }
    .tab-pane { display: none; }
    .tab-pane.active { display: block; }
    
    /* 访问记录样式 */
    .record-section {
      margin-top: 50px;
      padding: 20px;
      border: 1px solid #eee;
      border-radius: 6px;
    }
    .record-controls {
      display: flex;
      gap: 15px;
      margin-bottom: 20px;
      flex-wrap: wrap;
    }
    .search-box {
      display: flex;
      align-items: center;
      gap: 10px;
      flex: 1;
      min-width: 250px;
    }
    .search-input {
      padding: 8px;
      border: 1px solid #ddd;
      border-radius: 4px;
      flex: 1;
    }
    .search-btn {
      padding: 8px 15px;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .export-btn {
      padding: 8px 15px;
      background-color: #4caf50;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .password-btn {
      padding: 8px 15px;
      background-color: #ff9800;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    .record-table {
      width: 100%;
      border-collapse: collapse;
      margin-top: 20px;
    }
    .record-table th, .record-table td {
      padding: 10px;
      border: 1px solid #ddd;
      text-align: left;
    }
    .record-table th {
      background-color: #f5f5f5;
    }
    
    /* 模态框样式 */
    .modal {
      display: none;
      position: fixed;
      z-index: 200;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
    }
    .modal-content {
      background-color: #fefefe;
      margin: 15% auto;
      padding: 30px;
      border: 1px solid #888;
      width: 350px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
    }
    .close:hover, .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }
    .modal-title {
      margin-bottom: 20px;
      color: #333;
    }
    .modal-input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
      font-size: 14px;
    }
    .modal-btn {
      padding: 12px 20px;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
      margin-top: 15px;
    }
    .modal-btn:hover {
      background-color: #357abd;
    }
    .error-message {
      color: red;
      margin-top: 10px;
      display: none;
    }
    
    /* 登录模态框样式 */
    .login-modal {
      display: flex;
      position: fixed;
      z-index: 300;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      overflow: auto;
      background-color: rgba(0,0,0,0.4);
      align-items: center;
      justify-content: center;
    }
    .login-content {
      background-color: #fefefe;
      padding: 30px;
      border: 1px solid #888;
      width: 350px;
      border-radius: 8px;
      box-shadow: 0 5px 15px rgba(0,0,0,0.1);
    }
    .login-title {
      text-align: center;
      margin-bottom: 25px;
      color: #333;
    }
    .login-input {
      width: 100%;
      padding: 12px;
      margin: 10px 0;
      border: 1px solid #ddd;
      border-radius: 4px;
      box-sizing: border-box;
      font-size: 14px;
    }
    .login-btn {
      padding: 12px 20px;
      background-color: #4a90e2;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      width: 100%;
      font-size: 16px;
      margin-top: 15px;
    }
    .login-btn:hover {
      background-color: #357abd;
    }
    .login-error {
      color: red;
      margin-top: 10px;
      display: none;
      text-align: center;
    }
    .char-count {
      font-size: 12px;
      color: #666;
      text-align: right;
      margin-top: -5px;
    }
    
    /* 登出按钮样式 */
    .logout-btn {
      padding: 8px 15px;
      background-color: #f44336;
      color: white;
      border: none;
      border-radius: 4px;
      cursor: pointer;
      margin-left: auto;
    }
    .logout-btn:hover {
      background-color: #d32f2f;
    }
  </style>
</head>
<body>
  <!-- 登录模态框 -->
  <div id="login-modal" class="login-modal">
    <div class="login-content">
      <h2 class="login-title">请登录</h2>
      <div>
        <label for="employee-id">工号:</label>
        <input type="text" id="employee-id" class="login-input" placeholder="请输入工号" maxlength="10">
        <div class="char-count"><span id="employee-id-count">0</span>/10</div>
      </div>
      <div>
        <label for="name">姓名:</label>
        <input type="text" id="name" class="login-input" placeholder="请输入姓名">
      </div>
      <button id="login-btn" class="login-btn">登录</button>
      <p id="login-error" class="login-error">请输入工号和姓名</p>
    </div>
  </div>

  <!-- 导航栏 -->
  <nav class="navbar">
    <div class="nav-container">
      <ul class="nav-links">
        <li><a href="#home" class="nav-link active">首页</a></li>
        <li><a href="#tabs" class="nav-link">计量柜明细</a></li>
        <li><a href="#independent" class="nav-link">计量柜密钥</a></li>
        <li><a href="#records" class="nav-link">访问记录</a></li>
      </ul>
      <button id="logout-btn" class="logout-btn">登出</button>
    </div>
  </nav>

  <div class="container">
    <!-- 首页区域 -->
    <section id="home" class="section">
      <h1>1 计量器具领用与归还流程</h1>
      <p>1.1  扫码获取密钥后，选择所需计量器具，然后扫计量器具领用信息登记表进行登记完成领用流程。</p><br>
<p>1.2  填写了归还时间则请按所填时间归还，归还后请与计量员确认。</p><br>
<p>1.3  若未填写归还时间请再次扫计量器具领用信息登记表并完善所有信息</p><br>
      <p>1.4  注意事项：领用前须扫码登记相关信息，领用后须妥善保管，无使用需求及时归还。谢谢！</p>
    </section>

    <!-- 选项卡式加载区域 -->
    <section id="tabs" class="section">
      <h2>2  计量柜物品明细</h2>
      <div class="tab-buttons">
        <button class="tab-btn" data-tab="tab4">2号计量柜</button>
        <button class="tab-btn" data-tab="tab5">10号计量柜</button>
        <button class="tab-btn" data-tab="tab6">19号计量柜</button>
      </div>
      <div class="tab-content">
        <div class="tab-pane" id="tab4">
          <div class="content-loading" id="loading4">切换选项卡加载内容...</div>
          <div class="dynamic-content" id="dynamic4">选项卡内容4将在这里显示</div>
        </div>
        <div class="tab-pane" id="tab5">
          <div class="content-loading" id="loading5">切换选项卡加载内容...</div>
          <div class="dynamic-content" id="dynamic5">选项卡内容5将在这里显示</div>
        </div>
        <div class="tab-pane" id="tab6">
          <div class="content-loading" id="loading6">切换选项卡加载内容...</div>
          <div class="dynamic-content" id="dynamic6">选项卡内容6将在这里显示</div>
        </div>
      </div>
    </section>

    <!-- 独立按钮加载区域 -->
    <section id="independent" class="section">
      <h2>3  计量柜密钥</h2>
      <div class="load-area">
        <!-- 动态内容块1 -->
        <div class="load-card" id="card1">
          <h3>2号计量柜</h3>
          <button class="load-btn" data-target="content1">查看密钥</button>
          <div class="content-loading" id="loading1">！！！请勿泄密</div>
          <div class="dynamic-content" id="content1">
            <p><strong>2号计量柜密钥为5140。</strong>请勿泄密！</p>
            <p>数据更新时间：<span id="time1"></span></p>
          </div>
        </div>
        
        <!-- 动态内容块2 -->
        <div class="load-card" id="card2">
          <h3>10号计量柜</h3>
          <button class="load-btn" data-target="content2">查看密钥</button>
          <div class="content-loading" id="loading2">！！！请勿泄密</div>
          <div class="dynamic-content" id="content2">
            <p><strong>10号计量柜密钥为708！</strong>请勿泄密！</p><p>数据更新时间：<span id="time2"></span></p>
          </div>
        </div>
        
        <!-- 动态内容块3 -->
        <div class="load-card" id="card3">
          <h3>19号计量柜</h3>
          <button class="load-btn" data-target="content3">查看密钥</button>
          <div class="content-loading" id="loading3">！！！请勿泄密</div>
          <div class="dynamic-content" id="content3">
            <p><strong>19号计量柜密钥为0000！</strong>请勿泄密！</p><p>数据更新时间：<span id="time3"></span></p>
          </div>
        </div>
      </div>
    </section>

    <!-- 访问记录区域 -->
    <section id="records" class="section">
      <h2>4 访问记录</h2>
      <div class="record-controls">
        <div class="search-box">
          <input type="text" id="search-input" class="search-input" placeholder="输入关键词搜索...">
          <button id="search-btn" class="search-btn">搜索</button>
        </div>
        <button id="export-btn" class="export-btn">导出记录</button>
        <button id="password-btn" class="password-btn">修改密码</button>
      </div>
      <div id="records-content" class="dynamic-content">
        <table class="record-table">
          <thead>
            <tr>
              <th>序号</th>
              <th>会话ID</th>
              <th>工号</th>
              <th>姓名</th>
              <th>访问时间</th>
              <th>访问页面</th>
              <th>IP地址</th>
              <th>设备信息</th>
            </tr>
          </thead>
          <tbody id="records-body">
            <!-- 记录将通过JavaScript动态添加 -->
          </tbody>
        </table>
      </div>
    </section>
  </div>

  <!-- 验证模态框 -->
  <div id="verify-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3 class="modal-title">请输入验证码</h3>
      <input type="text" id="verify-code" class="modal-input" placeholder="输入验证码">
      <button id="verify-btn" class="modal-btn">验证</button>
      <p id="verify-error" class="error-message">验证码错误，请重新输入</p>
    </div>
  </div>

  <!-- 导出密码模态框 -->
  <div id="export-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3 class="modal-title">请输入导出密码</h3>
      <input type="password" id="export-password" class="modal-input" placeholder="输入导出密码">
      <button id="export-confirm-btn" class="modal-btn">确认</button>
      <p id="export-error" class="error-message">密码错误，请重新输入</p>
    </div>
  </div>

  <!-- 修改密码模态框 -->
  <div id="change-password-modal" class="modal">
    <div class="modal-content">
      <span class="close">&times;</span>
      <h3 class="modal-title">修改密码</h3>
      <div>
        <label>密保问题：网页制作者在家族中出生排名第几？</label>
        <input type="text" id="security-answer" class="modal-input" placeholder="请输入答案">
      </div>
      <div>
        <label>新的访问记录密码：</label>
        <input type="password" id="new-record-password" class="modal-input" placeholder="输入新密码">
      </div>
      <div>
        <label>新的导出密码：</label>
        <input type="password" id="new-export-password" class="modal-input" placeholder="输入新密码">
      </div>
      <button id="change-password-btn" class="modal-btn">修改</button>
      <p id="change-error" class="error-message">答案错误，无法修改密码</p>
    </div>
  </div>




  <!-- 原有代码保持不变... -->

  <footer class="main-footer">
    <div class="footer-container" style="display: flex; flex-wrap: wrap; justify-content: center; max-width: 1200px; margin: 0 auto;">
      <div class="footer-section" style="flex: 1; min-width: 250px; max-width: 300px; margin: 0 15px;">
        <h3 class="footer-title">联系我们</h3>
        <div class="contact-info" style="text-align: center;">
          <p><i class="fas fa-envelope"></i> <a href="mailto:邮箱" target="_blank">邮箱：暂无</a></p>
          <p><i class="fas fa-phone"></i> <a href="tel:+8617724675804">电话：+8617724675804</a></p>
          <p><i class="fas fa-map-marker-alt"></i> 地址中华人民共和国广东省</p>
        </div>
        <div class="social-links" style="justify-content: center;">
          <a href="#" target="_blank"><i class="fab fa-weixin"></i></a>
          <a href="#" target="_blank"><i class="fab fa-weibo"></i></a>
          <a href="#" target="_blank"><i class="fab fa-linkedin"></i></a>
        </div>
      </div>
      <div class="footer-section" style="flex: 1; min-width: 250px; max-width: 300px; margin: 0 15px;">
        <h3 class="footer-title">快速链接</h3>
        <ul class="footer-links" style="text-align: center;">
          <li><a href="#home">首页</a></li>
          <li><a href="#tabs">计量柜明细</a></li>
          <li><a href="#independent">计量柜密钥</a></li>
          <li><a href="#records">访问记录</a></li>
        </ul>
      </div>
      <div class="footer-section" style="flex: 1; min-width: 250px; max-width: 300px; margin: 0 15px;">
        <h3 class="footer-title">帮助中心</h3>
        <ul class="footer-links" style="text-align: center;">
          <li><a href="#" target="_blank">使用指南</a></li>
          <li><a href="#" target="_blank">常见问题</a></li>
          <li><a href="#" target="_blank">计量管理</a></li>
          <li><a href="#" target="_blank">联系支持</a></li>
        </ul>
      </div>
    </div>
    <div class="footer-bottom" style="text-align: center; max-width: 1200px; margin: 0 auto;">
      <p>&copy; 2025 计量器具管理系统. 保留所有权利。</p>
      <div class="footer-additional" style="display: flex; justify-content: center; gap: 20px; margin-top: 10px;">
        <a href="#" target="_blank">隐私政策</a>
        <a href="#" target="_blank">使用条款</a>
        <a href="#" target="_blank">Cookie政策</a>
      </div>
    </div>
  </footer>

  <!-- 原有代码保持不变... -->
  
  
    






  <script>
    // 显示字符计数
    document.getElementById('employee-id').addEventListener('input', function() {
      const count = this.value.length;
      document.getElementById('employee-id-count').textContent = count;
    });
    
    // 用户信息
    let currentUser = {
      employeeId: '',
      name: '',
      sessionId: ''
    };
    
    // 初始化访问记录数组
    let accessRecords = [];
    let filteredRecords = [];
    
    // 会话超时时间（毫秒），设置为10分钟
    const SESSION_TIMEOUT = 10 * 60 * 1000;
    let sessionTimer;
    
    // 默认密码和密保答案
    const DEFAULT_RECORD_PASSWORD = 'weihuadai';
    const DEFAULT_EXPORT_PASSWORD = 'weihuadai';
    const SECURITY_ANSWER = '排名第一';
    
    // 从本地存储加载密码设置
    let recordPassword = localStorage.getItem('recordPassword') || DEFAULT_RECORD_PASSWORD;
    let exportPassword = localStorage.getItem('exportPassword') || DEFAULT_EXPORT_PASSWORD;
    
    // 登录功能
    document.getElementById('login-btn').addEventListener('click', function() {
        const employeeId = document.getElementById('employee-id').value;
        const name = document.getElementById('name').value;
        
        if (!employeeId || !name) {
            document.getElementById('login-error').style.display = 'block';
            return;
        }
        
        // 生成会话ID
        currentUser.sessionId = generateSessionId();
        currentUser.employeeId = employeeId;
        currentUser.name = name;
        
        // 隐藏登录模态框
        document.getElementById('login-modal').style.display = 'none';
        
        // 记录登录访问
        recordAccess('登录成功');
        
        // 重置会话计时器
        resetSessionTimer();
        
        // 显示欢迎信息
        showWelcomeMessage();
    });
    
    // 生成会话ID
    function generateSessionId() {
        return 'SID-' + Math.random().toString(36).substr(2, 9).toUpperCase();
    }
    
    // 显示欢迎信息
    function showWelcomeMessage() {
        // 这里可以添加显示欢迎信息的代码
        console.log(`欢迎回来，${currentUser.name} (${currentUser.employeeId})`);
    }
    
    // 会话超时处理
    function resetSessionTimer() {
        clearTimeout(sessionTimer);
        sessionTimer = setTimeout(logout, SESSION_TIMEOUT);
    }
    
    // 登出功能
    document.getElementById('logout-btn').addEventListener('click', logout);
    
    function logout() {
        // 记录登出访问
        recordAccess('登出系统');
        
        // 重置用户信息
        currentUser = {
            employeeId: '',
            name: '',
            sessionId: ''
        };
        
        // 显示登录模态框
        document.getElementById('login-modal').style.display = 'flex';
        
        // 清除会话计时器
        clearTimeout(sessionTimer);
    }
    
    // 页面加载完成后检查是否需要登录
    document.addEventListener('DOMContentLoaded', function() {
        // 如果没有当前用户，显示登录模态框
        if (!currentUser.employeeId || !currentUser.name) {
            document.getElementById('login-modal').style.display = 'flex';
        }
        
        // 加载访问记录
        loadRecords();
        
        // 初始化页面
        initPage();
    });
    
    // 初始化页面
    function initPage() {
        // 可以在这里添加页面初始化代码
    }

    // 导航功能实现
    document.querySelectorAll('.nav-links a').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        
        document.querySelectorAll('.nav-links a').forEach(item => {
          item.classList.remove('active');
        });
        this.classList.add('active');
        
        const targetId = this.getAttribute('href');
        const targetElement = document.querySelector(targetId);
        
        // 特殊处理访问记录页面，需要验证密码
        if (targetId === '#records') {
          verifyModal.style.display = 'block';
          document.getElementById('verify-code').value = '';
          document.getElementById('verify-error').style.display = 'none';
        } else if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth'
          });
          
          // 记录导航访问
          recordAccess(targetId.replace('#', ''));
          resetSessionTimer();
        }
      });
    });

    window.addEventListener('scroll', () => {
      const sections = document.querySelectorAll('.section');
      const navLinks = document.querySelectorAll('.nav-links a');
      
      let currentSection = '';
      sections.forEach(section => {
        const sectionTop = section.offsetTop - 100;
        const sectionHeight = section.offsetHeight;
        if (window.scrollY >= sectionTop && window.scrollY < sectionTop + sectionHeight) {
          currentSection = '#' + section.getAttribute('id');
        }
      });
      
      navLinks.forEach(link => {
        link.classList.remove('active');
        if (link.getAttribute('href') === currentSection) {
          link.classList.add('active');
        }
      });
    });

    // 动态加载功能
    document.querySelectorAll('.load-btn').forEach(button => {
      button.addEventListener('click', function() {
        const targetId = this.getAttribute('data-target');
        const loadingEl = document.getElementById(`loading${targetId.replace('content', '')}`);
        const contentEl = document.getElementById(targetId);
        
        loadingEl.style.display = 'block';
        contentEl.style.display = 'none';
        this.disabled = true;
        this.innerHTML = '<span>加载中...</span>';
        
        const delay = 500 + Math.random() * 1000;
        setTimeout(() => {
          if (targetId === 'content1') {
            loadContent1(contentEl, loadingEl);
          } else if (targetId === 'content2') {
            loadContent2(contentEl, loadingEl);
          } else if (targetId === 'content3') {
            loadContent3(contentEl, loadingEl);
          }
          
          this.disabled = false;
          this.innerHTML = '查看密钥';
          
          // 记录按钮点击访问
          const cabinetNumber = targetId.replace('content', '');
          recordAccess(`查看${cabinetNumber}号计量柜密钥`);
          resetSessionTimer();
        }, delay);
      });
    });

    document.querySelectorAll('.tab-btn').forEach(button => {
      button.addEventListener('click', function() {
        document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
        this.classList.add('active');
        
        const tabId = this.dataset.tab;
        document.querySelectorAll('.tab-pane').forEach(pane => pane.classList.remove('active'));
        document.getElementById(tabId).classList.add('active');
        
        const loadingEl = document.getElementById(`loading${tabId.replace('tab', '')}`);
        const contentEl = document.getElementById(`dynamic${tabId.replace('tab', '')}`);
        
        loadingEl.style.display = 'block';
        contentEl.style.display = 'none';
        
        setTimeout(() => {
          if (tabId === 'tab4') {
            loadTabContent4(contentEl, loadingEl);
          } else if (tabId === 'tab5') {
            loadTabContent5(contentEl, loadingEl);
          } else if (tabId === 'tab6') {
            loadTabContent6(contentEl, loadingEl);
          }
          
          // 记录选项卡访问
          const cabinetNumber = tabId.replace('tab', '');
          recordAccess(`查看${cabinetNumber}号计量柜明细`);
          resetSessionTimer();
        }, 800);
      });
    });

    // 内容加载函数
    function loadContent1(contentEl, loadingEl) {
      const now = new Date();
      contentEl.querySelector('#time1').textContent = now.toLocaleString();
      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    function loadContent2(contentEl, loadingEl) {
       const now = new Date();
      contentEl.querySelector('#time2').textContent = now.toLocaleString();

      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    function loadContent3(contentEl, loadingEl) {
            const now = new Date();
      contentEl.querySelector('#time3').textContent = now.toLocaleString();

      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    function loadTabContent4(contentEl, loadingEl) {
      contentEl.innerHTML = `
        <p>这是2号计量柜的动态内容。</p>
        <p>加载时间：${new Date().toLocaleString()}</p>
        <img src="https://picsum.photos/800/400?random=1" alt="2号计量柜内部图片" style="width: 100%; margin-top: 10px; border-radius: 4px;">
      `;
      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    function loadTabContent5(contentEl, loadingEl) {
      contentEl.innerHTML = `
        <p>这是10号计量柜的动态内容。</p>
        <p>加载时间：${new Date().toLocaleString()}</p>
        <img src="https://picsum.photos/800/400?random=2" alt="10号计量柜内部图片" style="width: 100%; margin-top: 10px; border-radius: 4px;">
      `;
      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    function loadTabContent6(contentEl, loadingEl) {
      contentEl.innerHTML = `
        <p>这是19号计量柜的动态内容。</p>
        <p>加载时间：${new Date().toLocaleString()}</p>
        <img src="https://picsum.photos/800/400?random=3" alt="19号计量柜内部图片" style="width: 100%; margin-top: 10px; border-radius: 4px;">
      `;
      contentEl.style.display = 'block';
      loadingEl.style.display = 'none';
    }

    // 访问记录功能
    function recordAccess(page) {
      // 获取设备信息
      const userAgent = navigator.userAgent;
      
      // 获取IP地址（这里使用模拟，实际需要通过服务端获取）
      const ipAddress = '获取IP地址中...';
      
      // 创建新记录，包含用户信息和会话ID
      const newRecord = {
        id: accessRecords.length + 1,
        sessionId: currentUser.sessionId,
        employeeId: currentUser.employeeId,
        name: currentUser.name,
        time: new Date().toLocaleString(),
        page: page,
        ip: ipAddress,
        device: userAgent
      };
      
      // 添加到记录数组
      accessRecords.push(newRecord);
      
      // 保存到本地存储（永久保存）
      localStorage.setItem('accessRecords', JSON.stringify(accessRecords));
      
      // 尝试获取真实IP地址（通过API）
      fetch('https://api.ipify.org?format=json')
        .then(response => response.json())
        .then(data => {
          newRecord.ip = data.ip;
          localStorage.setItem('accessRecords', JSON.stringify(accessRecords));
          // 如果当前显示的是搜索结果，则不更新表格
          if (filteredRecords.length === 0) {
            displayRecords();
          }
        })
        .catch(error => {
          newRecord.ip = '无法获取IP';
          localStorage.setItem('accessRecords', JSON.stringify(accessRecords));
          if (filteredRecords.length === 0) {
            displayRecords();
          }
        });
    }
    
    // 加载本地存储中的记录
    function loadRecords() {
      const records = localStorage.getItem('accessRecords');
      if (records) {
        accessRecords = JSON.parse(records);
        filteredRecords = [...accessRecords];
      }
    }
    
    // 显示记录表格
    function displayRecords() {
      const recordsBody = document.getElementById('records-body');
      recordsBody.innerHTML = '';
      
      const recordsToDisplay = filteredRecords.length > 0 ? filteredRecords : accessRecords;
      
      if (recordsToDisplay.length === 0) {
        recordsBody.innerHTML = '<tr><td colspan="8">暂无访问记录</td></tr>';
        return;
      }
      
      // 按时间倒序排列
      recordsToDisplay.sort((a, b) => new Date(b.time) - new Date(a.time));
      
      recordsToDisplay.forEach(record => {
        const row = document.createElement('tr');
        row.innerHTML = `
          <td>${record.id}</td>
          <td>${record.sessionId}</td>
          <td>${record.employeeId}</td>
          <td>${record.name}</td>
          <td>${record.time}</td>
          <td>${record.page}</td>
          <td>${record.ip}</td>
          <td>${record.device}</td>
        `;
        recordsBody.appendChild(row);
      });
    }
    
    // 搜索记录
    function searchRecords(keyword) {
      keyword = keyword.toLowerCase();
      filteredRecords = accessRecords.filter(record => {
        return (
          record.sessionId.toLowerCase().includes(keyword) ||
          record.employeeId.toLowerCase().includes(keyword) ||
          record.name.toLowerCase().includes(keyword) ||
          record.time.toLowerCase().includes(keyword) ||
          record.page.toLowerCase().includes(keyword) ||
          record.ip.toLowerCase().includes(keyword) ||
          record.device.toLowerCase().includes(keyword)
        );
      });
      
      displayRecords();
    }
    
    // 搜索按钮点击事件
    document.getElementById('search-btn').addEventListener('click', function() {
      const keyword = document.getElementById('search-input').value;
      searchRecords(keyword);
    });
    
    // 搜索输入框回车键事件
    document.getElementById('search-input').addEventListener('keyup', function(event) {
      if (event.key === 'Enter') {
        const keyword = this.value;
        searchRecords(keyword);
      }
    });
    
    // 导出记录功能
    document.getElementById('export-btn').addEventListener('click', function() {
      exportModal.style.display = 'block';
      document.getElementById('export-password').value = '';
      document.getElementById('export-error').style.display = 'none';
    });
    
    // 验证模态框功能
    const verifyModal = document.getElementById('verify-modal');
    document.getElementById('verify-btn').addEventListener('click', function() {
      const code = document.getElementById('verify-code').value;
      
      if (code === recordPassword) {
        verifyModal.style.display = 'none';
        const targetElement = document.querySelector('#records');
        if (targetElement) {
          targetElement.scrollIntoView({
            behavior: 'smooth'
          });
          
          // 加载并显示记录
          loadRecords();
          displayRecords();
        }
      } else {
        document.getElementById('verify-error').style.display = 'block';
      }
    });
    
    // 关闭模态框
    document.querySelectorAll('.close').forEach(closeBtn => {
      closeBtn.addEventListener('click', function() {
        this.closest('.modal').style.display = 'none';
      });
    });
    
    // 点击模态框外部关闭
    window.addEventListener('click', function(event) {
      if (event.target.classList.contains('modal')) {
        event.target.style.display = 'none';
      }
    });
    
    // 导出记录确认
    const exportModal = document.getElementById('export-modal');
    document.getElementById('export-confirm-btn').addEventListener('click', function() {
      const password = document.getElementById('export-password').value;
      
      if (password === exportPassword) {
        exportModal.style.display = 'none';
        
        // 导出CSV文件
        const recordsToExport = filteredRecords.length > 0 ? filteredRecords : accessRecords;
        
        if (recordsToExport.length === 0) {
          alert('没有可导出的记录');
          return;
        }
        
        // 创建CSV内容
        let csvContent = "序号,会话ID,工号,姓名,访问时间,访问页面,IP地址,设备信息\n";
        
        recordsToExport.forEach(record => {
          csvContent += `${record.id},"${record.sessionId}","${record.employeeId}","${record.name}","${record.time}","${record.page}","${record.ip}","${record.device}"\n`;
        });
        
        // 创建Blob对象
        const blob = new Blob([csvContent], { type: 'text/csv;charset=utf-8;' });
        
        // 创建下载链接
        const link = document.createElement('a');
        const url = URL.createObjectURL(blob);
        
        link.setAttribute('href', url);
        link.setAttribute('download', `计量器具访问记录_${new Date().toLocaleString().replace(/[\/:*?"<>|]/g, '-')}.csv`);
        link.style.visibility = 'hidden';
        
        document.body.appendChild(link);
        link.click();
        document.body.removeChild(link);
        
        // 记录导出操作
        recordAccess('导出访问记录');
      } else {
        document.getElementById('export-error').style.display = 'block';
      }
    });
    
    // 修改密码功能
    document.getElementById('password-btn').addEventListener('click', function() {
      changePasswordModal.style.display = 'block';
      document.getElementById('security-answer').value = '';
      document.getElementById('new-record-password').value = '';
      document.getElementById('new-export-password').value = '';
      document.getElementById('change-error').style.display = 'none';
    });
    
    const changePasswordModal = document.getElementById('change-password-modal');
    document.getElementById('change-password-btn').addEventListener('click', function() {
      const answer = document.getElementById('security-answer').value;
      const newRecordPassword = document.getElementById('new-record-password').value;
      const newExportPassword = document.getElementById('new-export-password').value;
      
      if (answer === SECURITY_ANSWER) {
        if (newRecordPassword) {
          recordPassword = newRecordPassword;
          localStorage.setItem('recordPassword', newRecordPassword);
        }
        
        if (newExportPassword) {
          exportPassword = newExportPassword;
          localStorage.setItem('exportPassword', newExportPassword);
        }
        
        changePasswordModal.style.display = 'none';
        alert('密码修改成功！');
        
        // 记录密码修改操作
        recordAccess('修改访问记录和导出密码');
      } else {
        document.getElementById('change-error').style.display = 'block';
      }
    });
    
    // 初始加载记录
    loadRecords();
  </script>
</body>
</html>
  